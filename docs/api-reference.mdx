---
title: 'API Reference'
description: 'Complete API documentation with examples and usage'
---

# API Reference

This document provides a comprehensive reference for all API endpoints in the Renclave system, including request/response formats, authentication, and usage examples.

## Base URL

All API endpoints are relative to the base URL of your Renclave instance:

- **Development**: `http://localhost:9000`
- **Production**: `https://your-domain.com`

## Authentication

The Renclave API uses various authentication methods depending on the operation:

### API Key Authentication
```http
Authorization: Bearer your-api-key
```

### Organization-based Authentication
```http
X-Organization-ID: your-organization-id
```

## Common Response Formats

### Success Response
```json
{
  "id": "request-uuid",
  "result": {
    "OperationResponse": {
      "success": true,
      "data": { /* operation-specific data */ }
    }
  }
}
```

### Error Response
```json
{
  "error": "Error description",
  "code": 400,
  "request_id": "request-uuid"
}
```

## Health Check

### GET /health
Check the health status of the TEE instance.

**Response:**
```json
{
  "status": "healthy",
  "timestamp": "2024-01-01T00:00:00Z",
  "version": "1.0.0"
}
```

## Genesis Boot Operations

### POST /enclave/genesis-boot
Initialize a TEE instance with a quorum-based key management system.

**Request:**
```json
{
  "type": "ACTIVITY_TYPE_GENESIS_BOOT_V2",
  "timestampMs": "1703123456789",
  "organizationId": "your-org-id",
  "parameters": {
    "namespace_name": "qos-namespace",
    "namespace_nonce": 12345,
    "pivot": {
      "hash": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32],
      "args": ["arg1", "arg2"]
    },
    "manifest_members": [
      {
        "member_alias": "member1",
        "pub_key": [/* 65-byte P256 public key */]
      }
    ],
    "share_members": [
      {
        "member_alias": "member1",
        "pub_key": [/* 65-byte P256 public key */]
      }
    ],
    "threshold": 3
  }
}
```

**Response:**
```json
{
  "id": "request-uuid",
  "result": {
    "GenesisBootResponse": {
      "manifest_envelope": {
        "manifest": {
          "namespace": "qos-namespace",
          "nonce": 12345,
          "enclave": {
            "pcr0": [/* PCR values */],
            "pcr1": [/* PCR values */],
            "pcr2": [/* PCR values */],
            "pcr3": [/* PCR values */]
          },
          "quorum_public_key": [/* 32-byte quorum key */]
        }
      },
      "encrypted_shares": [
        {
          "member_alias": "member1",
          "encrypted_quorum_key_share": [/* encrypted share bytes */]
        }
      ]
    }
  }
}
```

## Share Management

### POST /enclave/inject-shares
Inject encrypted shares to reconstruct the quorum key.

**Request:**
```json
{
  "namespace_name": "qos-namespace",
  "namespace_nonce": 12345,
  "shares": [
    {
      "member_alias": "member1",
      "decrypted_share": [/* decrypted share bytes */]
    },
    {
      "member_alias": "member2",
      "decrypted_share": [/* decrypted share bytes */]
    }
  ]
}
```

**Response:**
```json
{
  "id": "request-uuid",
  "result": {
    "InjectSharesResponse": {
      "success": true
    }
  }
}
```

## Seed Generation

### POST /generate-seed
Generate a cryptographic seed phrase using the quorum key.

**Request:**
```json
{
  "seed_type": "wallet-seed",
  "seed_data": "user-specific-data"
}
```

**Response:**
```json
{
  "seed_phrase": "abandon abandon abandon abandon abandon abandon abandon abandon abandon abandon abandon about",
  "entropy": "0000000000000000000000000000000000000000000000000000000000000000",
  "strength": 256,
  "word_count": 24
}
```

## TEE-to-TEE Communication

### POST /enclave/share-manifest
Share manifest envelope between TEE instances.

**Request:**
```json
{
  "manifest_envelope": {
    "manifest": {
      "namespace": "qos-namespace",
      "nonce": 12345,
      "enclave": {
        "pcr0": [/* PCR values */],
        "pcr1": [/* PCR values */],
        "pcr2": [/* PCR values */],
        "pcr3": [/* PCR values */]
      },
      "quorum_public_key": [/* 32-byte quorum key */]
    }
  }
}
```

**Response:**
```json
{
  "id": "request-uuid",
  "result": {
    "ShareManifestResponse": {
      "success": true
    }
  }
}
```

### POST /enclave/generate-attestation
Generate attestation document for TEE-to-TEE communication.

**Request:**
```json
{
  "manifest_hash": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
  "pcr_values": [[], [], [], []]
}
```

**Response:**
```json
{
  "id": "request-uuid",
  "result": {
    "GenerateAttestationResponse": {
      "attestation_doc": [/* attestation document bytes */]
    }
  }
}
```

### POST /enclave/export-key
Export quorum key to another TEE instance.

**Request:**
```json
{
  "manifest_envelope": {
    "manifest": {
      "namespace": "qos-namespace",
      "nonce": 12345,
      "enclave": {
        "pcr0": [/* PCR values */],
        "pcr1": [/* PCR values */],
        "pcr2": [/* PCR values */],
        "pcr3": [/* PCR values */]
      },
      "quorum_public_key": [/* 32-byte quorum key */]
    }
  },
  "attestation_doc": [/* attestation document bytes */]
}
```

**Response:**
```json
{
  "id": "request-uuid",
  "result": {
    "ExportKeyResponse": {
      "encrypted_quorum_key": [/* encrypted quorum key bytes */],
      "signature": [/* signature bytes */]
    }
  }
}
```

### POST /enclave/inject-key
Inject encrypted quorum key from another TEE instance.

**Request:**
```json
{
  "encrypted_quorum_key": [/* encrypted quorum key bytes */],
  "signature": [/* signature bytes */]
}
```

**Response:**
```json
{
  "id": "request-uuid",
  "result": {
    "InjectKeyResponse": {
      "success": true
    }
  }
}
```

## Status and Monitoring

### GET /status
Get the current status of the TEE instance.

**Response:**
```json
{
  "status": "ApplicationReady",
  "timestamp": "2024-01-01T00:00:00Z",
  "phase": "ApplicationReady",
  "quorum_key_available": true,
  "threshold": 3,
  "members": 5
}
```

## Error Codes

### HTTP Status Codes
- **200 OK**: Request successful
- **400 Bad Request**: Invalid request format or parameters
- **401 Unauthorized**: Authentication required
- **403 Forbidden**: Insufficient permissions
- **404 Not Found**: Endpoint not found
- **500 Internal Server Error**: Server error

### Application Error Codes
- **1001**: Invalid namespace
- **1002**: Invalid threshold configuration
- **1003**: Insufficient shares for threshold
- **1004**: Key reconstruction failed
- **1005**: Invalid attestation document
- **1006**: State transition error
- **1007**: Cryptographic operation failed

## Usage Examples

### Complete TEE Setup
```bash
# 1. Genesis Boot
curl -X POST http://localhost:9000/enclave/genesis-boot \
  -H "Content-Type: application/json" \
  -d @genesis_request.json

# 2. Inject Shares
curl -X POST http://localhost:9000/enclave/inject-shares \
  -H "Content-Type: application/json" \
  -d @shares_request.json

# 3. Generate Seed
curl -X POST http://localhost:9000/generate-seed \
  -H "Content-Type: application/json" \
  -d '{"seed_type": "wallet", "seed_data": "user123"}'
```

### TEE-to-TEE Key Sharing
```bash
# 1. Share Manifest
curl -X POST http://localhost:9001/enclave/share-manifest \
  -H "Content-Type: application/json" \
  -d @manifest.json

# 2. Generate Attestation
curl -X POST http://localhost:9001/enclave/generate-attestation \
  -H "Content-Type: application/json" \
  -d @attestation_request.json

# 3. Export Key
curl -X POST http://localhost:9000/enclave/export-key \
  -H "Content-Type: application/json" \
  -d @export_request.json

# 4. Inject Key
curl -X POST http://localhost:9001/enclave/inject-key \
  -H "Content-Type: application/json" \
  -d @inject_request.json
```

## Rate Limiting

API endpoints are rate-limited to prevent abuse:

- **Genesis Boot**: 10 requests per minute
- **Seed Generation**: 100 requests per minute
- **TEE-to-TEE Operations**: 50 requests per minute
- **Status Checks**: 200 requests per minute

## Best Practices

### Request Handling
1. **Always include request IDs** for tracking and debugging
2. **Validate input parameters** before making requests
3. **Handle errors gracefully** with proper error codes
4. **Use appropriate timeouts** for long-running operations

### Security
1. **Use HTTPS in production** for all API communications
2. **Validate certificates** and use proper authentication
3. **Store sensitive data securely** and never log sensitive information
4. **Implement proper access controls** and authorization

### Performance
1. **Batch operations** when possible to reduce latency
2. **Cache responses** appropriately for read-only operations
3. **Monitor API usage** and performance metrics
4. **Implement retry logic** for transient failures

## SDKs and Libraries

### Rust
```toml
[dependencies]
renclave-client = "1.0.0"
```

### Go
```go
import "github.com/your-org/renclave-go-client"
```

### JavaScript/TypeScript
```bash
npm install @your-org/renclave-client
```

## Support and Resources

- **Documentation**: [https://docs.your-domain.com](https://docs.your-domain.com)
- **GitHub**: [https://github.com/your-org/renclave](https://github.com/your-org/renclave)
- **Community**: [https://discord.gg/your-community](https://discord.gg/your-community)
- **Support**: [support@your-domain.com](mailto:support@your-domain.com)
